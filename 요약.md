# 요약

## 1장

### 스프링 주요 특징

- 의존 주입 지원
- AOP 지원
- MVC 웹 프레임워크 제공
- JDBC, JPA 연동, 트랜잭션 처리 지원



## 2장

- `@Configuration` 애노테이션은 해당 클래스를 **스프링 설정 클래스로 지정한다**
- `@Bean` 애노테이션을 메서드에 붙이면 **해당 메서드가 생성한 객체를 스프링이 관리하는 빈 객체로 등록한다**

- `AnnotationConfigApplicationContext` 클래스는 자바 설정에서 정보를 읽어와 빈 객체를 생성하고 관리한다

- `ApplicationContext` 또는 `BeanFactory`는 빈 객체의 생성, 초기화, 보관, 제거 등을 관리한다
  - 그래서 **컨테이너(Container)**라고도 부른다, **스프링 컨테이너**



## 3장

- 의존 : 객체간의 의존을 의미
- **스프링이 어떤 객체를 생성하고, 의존을 어떻게 주입할지 정의한 설정 정보를 작성해야 된다**

```java
package config;

...

@Configuration
public class AppCtx {
	
	@Bean
	public MemberDao memberDao() {
		return new MemberDao();
	}
	
	@Bean
	public MemberRegisterService memberRegSvc() {
		return new MemberRegisterService(memberDao());
	}
	
	@Bean
	public ChangePasswordService changePwdSvc() {
		ChangePasswordService pwdSvc = new ChangePasswordService();
		pwdSvc.setMemberDao(memberDao());
		return pwdSvc;
	}
}
```

### DI 주입 방식

1. 생성자로 주입

   ```java
   @Configuration
   public class AppCtx {
   	
   	@Bean
   	public MemberDao memberDao() {
   		return new MemberDao();
   	}
   	
   	...
   	
   	@Bean
   	public MemberPrinter memberPrinter() {
   		return new MemberPrinter();
   	}
   	
   	@Bean
   	public MemberListPrinter listPrinter() {
   		return new MemberListPrinter(memberDao(), memberPrinter());	// 의존 객체 주입
   	}
   }
   ```

2. setter, getter로 주입

   ```java
   @Configuration
   public class AppCtx {
   	...
   	@Bean
   	public MemberInfoPrinter infoPrinter() {
   		MemberInfoPrinter infoPrinter = new MemberInfoPrinter();
   		infoPrinter.setMemberDao(memberDao());
   		infoPrinter.setPrinter(memberPrinter());
   		return infoPrinter;
   	}
   }
   ```

   

- **`@Autowired` 애노테이션**은 **스프링의 자동 주입 기능**을 위한 것

  - **해당 타입의 빈을 찾아서 필드에 할당한다**

  ```java
  public class MemberInfoPrinter {
      @Autowired							//@Autowired 붙임
  	private MemberDao memDao;
      @Autowired
  	private MemberPrinter printer;
  	
  	public void printMemberInfo(String email) {
  		Member member = memDao.selectByEmail(email);
  		
  		if(member==null) {
  			System.out.println("데이터 없음\n");
  			return;
  		}
  		printer.print(member);
  		System.out.println();
  	}
  
  	...
  	
  }
  ```

  - 두 필드에 `@Autowired` 애노테이션 붙였다

  - **`@Autowired` 애노테이션을 의존 주입 대상에 붙이면 스프링 설정 클래스의 `@Bean` 메서드에 의존 주입을 위한 코드를 작성하지 않아도 된다**

    ```java
    @Bean
    public MemberInfoPrinter infoPrinter(){
        MemberInfoPrinter infoPrinter = new MemberInfoPrinter();
        //infoPrinter.setMemberDao(memberDao());
    	//infoPrinter.setPrinter(memberPrinter());
        // 세터를 통해 의존 주입하지 않아도 스프링 컨테이너가 @Autowired를 붙인 필드에 자동으로 해당 타입의 빈 객체를 주입
        return infoPrinter
    }
    ```

- `@Import` : 두 개 이상의 설정 파일을 사용하는 또 다른 방법

  ```java
  @Configuration
  @Import({AppConf1.class, AppConf2.class})
  public class AppConfImport{
      
  }
  ```



## 4. 의존 자동 주입

- 자동 주입

  ```java
  @Configuration
  public class AppCtx {
  	
  	@Bean
  	public MemberDao memberDao() {
  		return new MemberDao();
  	}
  	
  	@Bean
  	public ChangePasswordService changePwdSvc() {
  		ChangePasswordService pwdSvc = new ChangePasswordService();
  		//pwdSvc.setMemberDao(memberDao());		// 의존 주입을 안해도 의존 객체가 주입된다
  		return pwdSvc;
  	}
  	
  }
  ```

  ```java
  public class ChangePasswordService {
  	@Autowired		//@Autowired 붙임
  	private MemberDao memberDao;
  	
  	public void changePassword(String email, String oldPwd, String newPwd) {
  		Member member = memberDao.selectByEmail(email);
  		
  		if(member == null)
  			throw new MemberNotFoundException();
  		
  		member.changePassword(oldPwd, newPwd);
  		
  		memberDao.update(member);
  	}
  	
  	public void setMemberDao(MemberDao memberDao) {
  		this.memberDao = memberDao;
  	}
  }
  ```

- **의존을 주입할 대상에 `@Autowired` 애노테이션을 붙이면 된다**



- `@Autowired`는 메서드에도 붙일 수 있다

  - 빈 객체의 메서드에 `@Autowired`를 붙이면 스프링은 해당 메서드를 호출한다
    - 메서드 파라미터 타입에 해당하는 빈 객체를 찾아 인자로 주입한다
    - 예시 코드에서 메서드 파라미터로, 빈 객체 `memberDao`, `printer`가 있다

  ```java
  public class MemberInfoPrinter {
  	private MemberDao memDao;
  	private MemberPrinter printer;
  	
  	public void printMemberInfo(String email) {
  		Member member = memDao.selectByEmail(email);
  		
  		if(member==null) {
  			System.out.println("데이터 없음\n");
  			return;
  		}
  		printer.print(member);
  		System.out.println();
  	}
  	
  	@Autowired		// 추가
  	public void setMemberDao(MemberDao memberDao) {
  		this.memDao = memberDao;
  	}
  
      @Autowired		// 추가
  	public void setPrinter(MemberPrinter printer) {
  		this.printer = printer;
  	}
  	
  }
  ```



- 자동 주입이 가능한 빈이 두 개 이상인 경우 **자동 주입할 빈을 지정할 수 있도록**

  - **`@Qualifier` 애노테이션을 사용한다**
  - 자동 주입 대상을 한정할 수 있다

  ```java
  	@Bean
  	@Qualifier("printer")
  	public MemberPrinter memberPrinter1() {
  		return new MemberPrinter();
  	}
  
  	@Bean
  	public MemberPrinter memberPrinter2() {
  		return new MemberPrinter();
  	}
  ```

  - 혹은 **자동 주입할 빈을 한정할 때 사용**

  ```java
  public class MemberListPrinter {
  	private MemberDao memberDao;
  	private MemberPrinter printer;
  	
  	...
  
  	@Autowired
      @Qualifier("printer")
  	public void setMemberPrinter(MemberPrinter printer) {
  		this.printer = printer;
  	}
  	
  }
  ```

  

- **자동 주입에서 NULL 처리 방법** => 4장 md파일 확인